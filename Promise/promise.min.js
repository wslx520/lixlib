!function(n){function t(n){return"function"==typeof n}function e(n){return n&&t(n.then)?n.then:void 0}function r(n,t,e){var r=!1;try{n(function(n){r||(r=!0,t(n))},function(n){r||(r=!0,e(n))})}catch(o){if(r)return;r=!0,e(o)}}var o=n.Promise;if(o)return void(o.prototype.fail=o.prototype["catch"]);var c=n.Promise=function(n){function o(n){try{var t=e(n);t?r(function(n,e){t(n,e)},o,i):(p=!0,v=n,f())}catch(c){i(c)}}function i(n){p=!1,v=n,f()}function u(n){p===s?h.push(n):setTimeout(function(){var t=p?n.onFulfilled:n.onRejected;if(t===s)(p?n.resolve:n.reject)(v);else try{var e=t(v);n.resolve(e)}catch(r){n.reject(r)}},0)}function f(){for(l=0,a=h.length;a>l;l++)u(h[l]);h=s}var l,a,h=[],s=null,v=s,p=s,y=this;this.then=function(n,e){return new c(function(r,o){u({onFulfilled:t(n)?n:s,onRejected:t(e)?e:s,resolve:r,reject:o})})},r(n,o,i)};c.prototype["catch"]=c.prototype.fail=function(n){return this.then(nul,n)},c.all=function(n){var t=Array.prototype.slice.call(1===arguments.length&&arguments[0].splice?arguments[0]:arguments);return new c(function(n,r){function o(i,u){try{var f=e(u);if(f)return void f(function(n){o(i,n)},r);t[i]=u,0===--c&&n(t)}catch(l){r(l)}}if(0===t.length)return n([]);for(var c=t.length,i=0;i<t.length;i++)o(i,t[i])})},c.race=function(n){return new c(function(e,r){for(var o,c=0,i=n.length;i>c;c++)if(o=n[c],o!=nul&&t(o.then))o.then(e,r);else try{e(o)}catch(u){r(u)}})},c.resolve=function(n){return n&&"object"==typeof n&&n.constructor===c?n:new c(function(t){t(n)})},c.reject=function(n){return new c(function(t,e){e(n)})}}(window);