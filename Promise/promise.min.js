!function(n,t){function e(n){return"function"==typeof n}function r(n){return n&&e(n.then)?n.then:t}function o(n,t,e){var r=!1;try{n(function(n){r||(r=!0,t(n))},function(n){r||(r=!0,e(n))})}catch(o){if(r)return;r=!0,e(o)}}var c=n.Promise;if(c)return void(c.prototype.fail=c.prototype["catch"]);var i=n.Promise=function(n){function c(n){try{var t=r(n);t?o(function(n,e){t(n,e)},c,u):(p=!0,v=n,l())}catch(e){u(e)}}function u(n){p=!1,v=n,l()}function f(n){p===t?s.push(n):setTimeout(function(){var e=p?n.onFulfilled:n.onRejected;if(e===t)(p?n.resolve:n.reject)(v);else try{var r=e(v);n.resolve(r)}catch(o){n.reject(o)}},0)}function l(){for(a=0,h=s.length;h>a;a++)f(s[a]);s=t}var a,h,s=[],v=t,p=t,y=this;this.then=function(n,r){return new i(function(o,c){f({onFulfilled:e(n)?n:t,onRejected:e(r)?r:t,resolve:o,reject:c})})},o(n,c,u)};i.prototype["catch"]=i.prototype.fail=function(n){return this.then(t,n)},i.all=function(n){var t=Array.prototype.slice.call(1===arguments.length&&arguments[0].splice?arguments[0]:arguments);return new i(function(n,e){function o(i,u){try{var f=r(u);if(f)return void f(function(n){o(i,n)},e);t[i]=u,0===--c&&n(t)}catch(l){e(l)}}if(0===t.length)return n([]);for(var c=t.length,i=0;i<t.length;i++)o(i,t[i])})},i.race=function(n){return new i(function(r,o){for(var c,i=0,u=n.length;u>i;i++)if(c=n[i],c!=t&&e(c.then))c.then(r,o);else try{r(c)}catch(f){o(f)}})},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i(function(t){t(n)})},i.reject=function(n){return new i(function(t,e){e(n)})}}(window,null);