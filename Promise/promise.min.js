!function(n){function t(n){return"function"==typeof n}function e(n){return n&&t(n.then)?n.then:void 0}function r(n,t,e){var r=!1;try{n(function(n){r||(r=!0,t(n))},function(n){r||(r=!0,e(n))})}catch(o){if(r)return;r=!0,e(o)}}var o=n.Promise;if(o)return void(o.prototype.fail=o.prototype["catch"]);var u=n.Promise=function(n){function o(n){try{var t=e(n);t?r(function(n,e){t(n,e)},o,c):u(!0,n)}catch(i){c(i)}}function u(n,t){v=n,s=t,l()}function c(n){u(!1,n)}function i(n){null===v?h.push(n):setTimeout(function(){var t=v?n.onFulfilled:n.onRejected;if(null===t)(v?n.resolve:n.reject)(s);else try{var e=t(s);n.resolve(e)}catch(r){n.reject(r)}},0)}function l(){for(f=0,a=h.length;a>f;f++)i(h[f]);h=null}var f,a,h=[],s=null,v=null,p=this;this.then=function(n,e){return new p.constructor(function(r,o){i({onFulfilled:t(n)?n:null,onRejected:t(e)?e:null,resolve:r,reject:o})})},r(n,o,c)};u.prototype["catch"]=u.prototype.fail=function(n){return this.then(null,n)},u.all=function(n){var t=Array.prototype.slice.call(1===arguments.length&&arguments[0].splice?arguments[0]:arguments);return new u(function(n,r){function o(c,i){try{var l=e(i);if(l)return void l(function(n){o(c,n)},r);t[c]=i,0===--u&&n(t)}catch(f){r(f)}}if(0===t.length)return n([]);for(var u=t.length,c=0;c<t.length;c++)o(c,t[c])})},u.race=function(n){return new u(function(e,r){for(var o,u=0,c=n.length;c>u;u++)if(o=n[u],null!=o&&t(o.then))o.then(e,r);else try{e(o)}catch(i){r(i)}})},u.resolve=function(n){return n&&"object"==typeof n&&n.constructor===u?n:new u(function(t){t(n)})},u.reject=function(n){return new u(function(t,e){e(n)})}}(window);